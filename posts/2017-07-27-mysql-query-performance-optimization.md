# Bassic

|   layout   |    title   |
|:----------:|:----------:|
|   post     | MySQL查询性能优化 |

## 查询速度慢的原因

如果把查询看作是一个任务，那么它由一系列子任务组成，每个任务都会消耗一定时间。

优化查询即优化子任务 1. 消除其中一些子任务 2. 减少子任务的执行次数 3. 让子任务运行的更快

在执行查询的时候，哪一些子任务运行的慢？

## 慢查询基础：优化数据访问

问题：访问的数据太多

检查方式：

1. 应用程序是否检索超过需要的数据，数据包括行、列。


```json

案例

a. 查询全部结果集。最简单的办法是在查询后加LIMIT

b. 多表关联返回全部列。在查询语句不用"SELECT *"(这个语句的代价是缓存所有列的查询)，而用需要的字段。

c. 重复查询相同的数据。

```

2. 服务器层是否分析大量超过需要的数据行。


```json

指标

a. 响应时间。包含服务时间和排队时间。

b. 扫描的行数和访问的行数。扫描的行数越接近访问的行数，查询效率越高。

c. 扫描的行数和访问类型。 EXPLAIN中的type列代表访问类型，速度从慢到快、扫描行数从多到少包括全表扫描、索引扫描、范围扫描、唯一索引查询、常数引用。

使用WHERE条件，从好到坏依次为:

a. 在索引中使用where条件过滤不匹配的记录。在存储引擎层完成。

b. 使用索引覆盖扫描来返回记录。在MySQL服务器层完成。

c. 从数据表中返回数据，过滤不满足条件的记录(Extra列中出现using where)。在MySQL服务器层完成。


```

